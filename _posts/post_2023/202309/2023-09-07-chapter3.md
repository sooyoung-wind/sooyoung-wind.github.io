---
layout: post
title: 3장 문제해결 프로세스 및 체크리스트
tags: [Kaggle, python]
categories: [Kaggle, python]
sitemap:
changefreq: daily
priority : 1.0
---

[Musthave 머신러닝 딥러닝 문제해결 전략](https://www.yes24.com/Product/Goods/108802734)의 3장(문제해결 프로세스 및 체크리스트)에 대한 학습한 내용을 정리했다.  
도서 깃허브 주소는 [링크](https://github.com/BaekKyunShin/musthave_mldl_problem_solving_strategy)를 확인하세요.  

----

목차
- toc
{: toc }

----  

## 학습 목표  

- 캐글대회를 참가하는데 알아두면 좋은 프로세스를 학습한다.
- 프로세스의 각 단계마다 체크리스트를 사용하여 내용을 학습한다.

<br>

----  

## 머신러닝 대회 vs. 딥러닝 대회  
+ 머신러닝 대회 : 엑셀, csv 파일와 같이 표로 표현이 가능한 데이터를 다루는 대회
+ 딥러닝 대회 : 딥러닝 기법을 활용해 이미지, 음성, 텍스트와 같은 데이터를 다루는 대회  

### 머신러닝, 딥러닝 차이  
+ 머신러닝은 알고리즘을 사용하여 데이터를 분석하고 학습하며, 학습한 내용을 근거로 입력된 데이터에 대한 결정을 한다.  
+ 딥러닝은 알고리즘을 계층으로 구성하여 자체적으로 학습하고 지능적인 결정을 내릴 수 있는 '인공 신경망'을 만듭니다.  
+ 딥러닝은 머신러닝의 하위 개념이고, 둘 다 광범위한 인공 지능의 폭넓은 범주에 속하지만 현재 인간과 가장 유사한 AI는 딥러닝이라고 한다.  


    > 손전등의 예로 들어보면, **머신러닝**은 '어둡다'라는 소리 신호를 입력받으면 손전등이 켜지도록 학습한다.  

    > **딥러닝**은 '어둡다'라는 소리 신호 뿐만 아니라 '안 보여' 또는 '스위치가 안 켜져'와 같은 신호가 들어오면 빛 센서와 함께 불이 켜지도록 구성되는 모델을 뜻한다. 

<br>  

----  

## 3.1 문제해결 프로세스  

> **[Note]**  
> 이번 장의 내용은 이 책 전반에서 반복 숙달하기 때문에 지금은 전체적인 흐름과 느낌만 기억해두시면 충분합니다.  

**머신러닝 프로세스**  

![머신러닝 프로세스](/assets/img/my_photo/chapter3_1.png)  


**딥러닝 프로세스**  

![딥러닝 프로세스](/assets/img/my_photo/chapter3_2.png)  


### 1. 문제 이해(경진대회)(공통)  
- 경진대회의 배경과 목적을 확인  
    참조 : [구글에서 개최한 대회](https://www.kaggle.com/competitions/asl-fingerspelling)

- 평가지표 파악 : 대회에서 평가하는 지표 확인(필수사항) 
![평가지표](/assets/img/my_photo/chapter3_3.png)  


### 2. 탐색적 데이터 분석  
- 머신러닝
    - 데이터 구조 탐색 : 데이터 구조를 간단히 확인하거나 몇 가지 통계를 구해보는 과정
    - 데이터 시각화  
        - 막대 그래프, 박스플롯과 같은 다양한 그래프를 활용
        - 중요한 피처(feaure) 파악
        - 피치들의 조합으로 새로운 피처를 생성 여부 확인  
        - 모델링 단계에서 주의할 점 등을 파악  
<br>

- 딥러닝
    - 데이터 구조 탐색 : 학습하는 데이터가 대부분 이미지이므로 이미지의 메타 정보를 파악  
    - 데이터 시각화  
        - **타깃값 분포**를 시각화하거나 이미지 데이터를 출력
            - 타깃값 분포에 대한 불균형 여부 판단
            - 데이터 출력을 통해 어떤 이미지를 훈련할지 확인
        - 데이터 수 확인(데이터 수가 부족하면 데이터 증강 요구)  

<br>

### 3. 베이스라인 모델  

- 머신러닝  
    - 모델 훈련 및 성능 검증 : 간단한 모델 생성 및 훈련  
        - 뼈대 역할을 하는 기본적인 머신러닝 파이프라인을 구축  
        - 필요하면 간단한 피처 엔지니링을 추가 수행  
        - 성능에 집중하지 않고 훈련까지 마무리된 완성본 구축  
    
    - 결과 예측 및 제출
        - 기본적인 머신러닝 파이프라인에 대한 성능 테스트  
        - 베이스라인 모델의 예측결과를 기반으로 성능 개선 후 비교하기 위함  
<br>

- 딥러닝  
    - 환경 설정 : 결과값을 재현할 수 있게 시드값을 고정(GPU 설정 등)  
    - 데이터 준비  
        - 사용할 **딥러닝 프레임워크**에 맞쳐 데이터 준비  
        - 파이토치일 경우 전용 **데이터셋 클래스**와 **데이터 로더** 생성  
        - 필요하면 **데이터 증강** 수행
    - 모델 훈련 및 성능 검증  
        - 기본적인 딥러닝 파이프라인 구축(신경망 모델을 직접 설계하거나 **사전 훈련** 모델을 불러와 사용)  
        - 훈련 전에 **손실 함수** 및 **옵티마이저**를 설정  
    - 결과 예측 및 제출(머신러닝과 동일))

### 4. 성능 개선  

- 머신러닝  
    - 피처 엔지니어링(특성 공학)  
        - 성능 개선의 첫 단계(이상치 제거, 결측밧 처리, 데이터 인코딩, 피처 스케일링, 파생 피처(변수) 생성, 피처 제거 및 선택 등)  
            > **[Note]**  
            > 모든 피처가 타깃값 예측에 필요하지 않음  
            > 필요한 피처는 원본 또는 변환을 거쳐 사용   
            > 불필요한 피처는 삭제

    - 하이퍼 파라미터 최적화 
        - 모델의 최적 하이퍼 파라미터를 찾는 작업  
        - 하이퍼 파라미터 최적화 기법으로는 **그리드 서치, 랜덤 서치, 베이지안 최적화** 등이 있음  
    
    - 성능 검증 : 훈련된 모델의 **일반화 성능**을 평가  
        - 훈련 데이터(train dataset)와 검증 데이터 조합(valid dataset)
        - 교차 검증(cross validation) : 가장 일반적인 k-fold cross validation이 있으며, 데이터 셋트를 훈련 데이터와 검증 데이터를 구분하는 조합을 k개 만큼 만들어 훈련하는 방법  
        - 성능이 안좋다면 EDA 또는 Feature engineering부터 수행하기도 함    
        <br>
        ![교차검증](/assets/img/my_photo/chapter3_4.png)  
<br>
    - 결과 예측 및 제출  
        - 캐글에서는 최종 버전 2개를 선택해서 제출함 
        - 만약 총 50개의 결과를 제출했다면 그 중 2개를 선택해서 제출을 하면 캐글에서 둘 중 점수가 높은 결과를 채택함  
<br>

- 딥러닝
    - 성능 개번 기법 적용
        - 다양한 기법이 존재함  
        - **옵티마이저**와 **스케줄러**를 새롭게 설정  
        - 예측 단계에서 수행하는 **테스트 단계 데이터 증강(TTA), 레이블 스무딩**을 적용  
        - **앙상블**모델을 구성해서 성능 개선  
    - 성능 검증 : 훈련된 모델의 **일반화 성능**을 평가  
        - 성능이 안좋다면 EDA 또는 Feature engineering부터 수행하기도 함  
    - 결과 예측 및 제출(머신러닝과 동일)

<br>  

----  

## 3.2 문제해결 체크리스트  

- [머신러닝 문제해결 체크리스트](https://bit.ly/3muJFV2)  
- [딥러닝 문제해결 체크리스트](https://bit.ly/3Bs6tLG)

> **[Note]**  
> 책에서 제시된 체크리스트는 대회용이므로 현업에 적용하기엔 어려움이 있으므로 실무에서 적용할 경우 참고하거나 중간에 문제가 잘 풀리지 않을 때 '당연한 걸 잊고 있는 건 없는지' 확인하는 용도로 활용 될 수 있다.  


