---
layout: post
title: 시리 클론코딩 프로젝트(python)
tags: [python DataBase]
categories: [python DataBase]
sitemap:
  changefreq: weekly
  priority : 1.0
---
음성인식 AI서비스와 유사한 프로젝트를 1주일간 진행했다. 이와 관련된 정보를 적어본다. 부트캠프 첫번째 프로젝트!

목차
- toc
{: toc }

----
#### 프로젝트 개요

프로젝트는 음성인식 AI서비스와 유사하게 유저의 목소리를 마이크로 AI서비스의 호출명을 부르면 이를 인식하여 명령을 받는 기본적인 AI서비스를 구축을 목적으로 두고 있다.  
AI서비스가 가능한 기능으로는 검색, 날씨, 미세먼지로, 게임(단순한 끝말잇기)으로 구성해보았다.  

#### 버전 1 완료

버전 1의 구성은 보이스 기능은 제외하여 구현했다. 또한 클래스와 함수를 적절하게 구성해야 하는데 버전1에서는 함수로만 구성되어 있다. 생각보다 클래스를 구현하는게 나한테는 어려워 보였다.  

날씨, 미세먼지, 검색 기능이 적절하게 작동하는지 키보드 입력방식으로 동작이 되는지 테스트를 수행했다. 사용하는 편집기 특성상 `if __name__ == "__main__"` 구문을 안넣어도 동작하지만, 나름 사용도 해보았다. 다른 편집기인 **VSCode**에서 사용할 때 아주 유용해 보인다.

버전 1이 완성되고 나서 멘토님과 상담을 진행했다. 클래스를 사용하고 있지 못해서 요청을 했고 많은 예시와 방법을 알려주셨다. 그래도 확실히 나에겐 너무 먼 클래스인가 보다.

----

#### 버전 2 완료

버전 2에서 많이 변경되었지만 총 3가지가 업데이트되었다.
1. AI 음성인식 클래스
2. 유저 DB 구축
3. 게임 기능 추가(DB로 구현)

##### AI 음성인식 클래스

몇일 고민한 끝에 음성인식을 클래스로 구현해보았다. 특히 아래 그림에서와 같이 각 기능을 구현하는 함수가 AI 객체(클래스)를 파라미터로 입력받는 구조로 구성했다. 함수는 AI 객체를 입력받아 필요한 문자열을 보이스로 송출할때 AI 객체의 메서드를 사용했다.

![그림](/assets/img/my_photo/class_to_function.png)

왜 이렇게 구현한 이유는 크롬드라이버로 네이버 또는 구글에서 검색요청을 계속하면 새로운 창이 계속 열렸다. 이를 해결하기 위해서 크롬드라이버의 객체를 AI calss의 객체가 들고 다닐 수 있도록 했다. **다행이도 성공이라고 본다.**

만들고 보니 다른 기능 예를 들어서 노래 재생이라는 기능을 추가하게 된다면 AI가 보유한 메서드(음성, 크롬 등)의 기능을 살릴 수 있어서 괜찮은 구성이라고 생각한다. 

##### 유저 DB 구축

클래스를 어떻게 구현할까 고민하다가 본 프로젝트와 상관없이 유저 DB를 구축해봤다. DB는 python에서 sqlite3 모듈을 이용했다. 솔직히 잘모르는데 사용법이 어려운 편이 아니라서 패캠에서 제공한 온라인 강의를 듣고 충분히 구현이 가능했다. 거의 명령어 옆에 창에 띄워놓고 보면서 했다. 😂

먼저 SQL에 사용되는 명령어들을 python으로 구현하기 위해서 함수로 만들어봤다. 기본적인 insert, delete를 시작으로 수정할 수 있는 기능까지 넣다보니 DB 조회 기능이 필요해서 점차 많은 함수를 만들게 되었다. **SQL_handing.py**에 SQL관련된 함수가 모여진 셈이다. 이걸 클래스로 구현할까 고민 중이지만, 시간이 부족해서 여기서 마무리...

##### 게임 기능

일단 API로 할려고 했는데 사이트가 불안정한지 접속이 잘안된다.🤔

게임은 끝말잇기 게임이다. 유저가 단어를 말하면 마지막 음절과 같은 단어를 사전에서 검색하고 말하고 다시 유저가 그 단어를 듣고 이어서 단어를 말하는 아주 간단한 게임이다.

근데, 생각보다 로직이 복잡해진다. 일단 마지막 음절로 연결되는 단어인지 확인해야 한다. 그 다음에 사전에 있는 단어인지 조회를 해야 한다. 사전에 없는 단어이면 다시 유저가 말할 수 있는 기회를 주는 방향인데...😵‍💫....난 무식하니 안되는듯 결국 코인이라는 개념을 도입해서 1개 추가 감소하고 코인을 다 소모하게 되면 유저가 진걸로 구성했다.(무식하게 `while, if, for`로 해결함)

그 다음 문제는 위의 검색조건이 맞는지 중복이 되는 경우였다. 그래서 단어 체크라는 `Ture, False` 기능을 부여했다.

막상 적어보면서 생각해보니 간단한 문제였던거 같기도 하다. 다만, 게임에 관련된 코드들이 하나의 파일에 구성되어 지저분하게 느껴진다.

##### 프로젝트 후기

+ 배운점   

클래스를 나름 처음으로 활용해본거 같다. 왠지 클래스를 쓸 정도의 프로젝트가 아닌거 같다는 생각도 해봤지만 멘토님을 통해 새롭게 클래스를 도전하고 만든거 같다.

SQL을 배우고 프로젝트에 적용해본게 도움이 되었다. 어떻게 흘러가는지 개념도 알게 생각보다 SQL의 명령어는 쉬워보였는데 확실히 직접 python에서 구동할 수 있게 구현하는게 힘들었다.

그리고 점차 늘어가는 Git.. 아직 배울게 많이 있지만 이렇게라도 천천히 Git을 활용하면서 실력을 조금이라도 늘려가고 있다.

+ 아쉬운점

Git에 `pip install Git주소`로 배포까지 구현하고 싶었다. 생각과 마음은 항상 앞서가 있는거 같다. 

이제 다른 수강생분들이 만든 코드를 보러 가보자~~!!😄

----
#### 찐 후기
> **내가 앞으로 연습해야할 것들**  

**1. 코드를 구조화 하자**  

1개의 목적에 1개의 클래스를 만들어야 한다. 1개의 함수에 1개의 기능만 구현되어야 한다. 최대한 다른 사람이 유지보수를 할 수 있고 언제든지 본인 스스로 코드를 볼 때 알 수 있도록 구현하는게 가장 큰 핵심이라고 한다. (기능구현은 어차피 나중에 다 할 수 있다고 함)

이번 프로젝트에서는 1. 음성인식, 2. 날씨, 3. 게임 이렇게 3개의 클래스로 구성할 수 있다고 볼 수 있다.


**2. if, for문을 많이 줄이기(가독성이 없음)**

방법은 아래와 같이 딕셔너리 형태로 {명령 - 실행될 함수}를 선언해서 사용한다.

```python
# 행동에 대한 정의 어떤 단어에 어떤 함수를 사용할지 
# command에 있는게 함수임
self.action_phrase =
  {'검색': {'type': 'act','need_args': True,
            'msg': '검색하겠습니다', 'command': crawl_naver},
   '날씨': {'type': 'speak', 'need_args': True,
            'msg': '실시간 날씨 알려드릴게요', 'command': self.weather_api.get_weather},
    '미세먼지': {'type': 'speak', 'need_args': True,
            'msg': '실시간 미세먼지 알려드릴게요', 'command': self.weather_api.get_airinfo},
    '게임': {'type': 'act', 'need_args': False,
            'msg': '시작하겠습니다', 'command': self.relay_game.start}}

# 에러에 대한 선택
self.error_phrase = {'type': None, 'need_args': None, 'msg': '다시 말씀해주세요.', 'command': None}
```

다음으로 `if`문에 `return`을 넣어서 함수가 종료되도록 구성하면 return 조건 이하 실행할 문장들은 `else`로 구현된다.

```python
if (조건문):
    return 실행할 문장

이하 else로 실행할 문장
```

**리스트 컴프리헨션 사용 이거는 앞으로도 엄청 노력해서 구현필수**
너무 많은 if문과 for문의 중첩으로 객층이 너무 깊어져서 가독성이 많이 떨어지는 문제를 해결할 수 있다.

